<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Team Page</title>
    <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>

<!-- shader -->
<script type="x-shader/x-vertex" id="vertexshader">
    uniform sampler2D depthMap;
    uniform float maxDepth;
    uniform float pointSize;

    attribute vec2 texcoord;

    varying vec2 tc;
    varying float lum;

    void main() {
        tc = texcoord;

        vec4 depth = texture2D(depthMap, texcoord);

        // calculate luminance
        vec3 luminanceVector = vec3(0.2125, 0.7154, 0.0721);
        float luminance = dot(luminanceVector, depth.xyz);
        lum = luminance;

        // lerp z by luminance
        vec3 pt = position;
        pt.z += maxDepth * luminance;

        vec4 mvPosition = modelViewMatrix * vec4(pt, 1.0);
        gl_PointSize = pointSize;
        gl_Position = projectionMatrix * mvPosition;
    }
</script>

<script type="x-shader/x-fragment" id="fragmentshader">
    uniform sampler2D colorMap;

    varying vec2 tc;
    varying float lum;

    void main() {
        // read color from color map
        vec4 color = texture2D(colorMap, tc);

        // clip image
        gl_FragColor = color;

        if (gl_FragColor.a < ALPHATEST) discard;
    }
</script>

<canvas id="mainCanvas"></canvas>

<div id="content">
    <div class="cards">
        <div class="card">
            <div class="scene"
                 data-color="assets/images/emil_color.png"
                 data-depth="assets/images/emil_depth.png"></div>
            <div class="description">Emil</div>
        </div>
        <div class="card">
            <div class="scene"
                 data-color="assets/images/emil_color.png"
                 data-depth="assets/images/emil_depth.png"></div>
            <div class="description">Oskar</div>
        </div>
        <div class="card">Three</div>
        <div class="card">Four</div>
    </div>
</div>

<script src="bundle.js"></script>
</body>
</html>